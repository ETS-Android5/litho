apply plugin: 'com.android.library'

android {
    compileSdkVersion rootProject.compileSdkVersion
    buildToolsVersion rootProject.buildToolsVersion

    defaultConfig {
        minSdkVersion rootProject.minSdkVersion
        targetSdkVersion rootProject.targetSdkVersion
    }
}

dependencies {
    implementation deps.soloader
    implementation deps.jsr305
    implementation deps.inferAnnotations
    implementation project(':litho-annotations')
    compileOnly    deps.proguardAnnotations
}

// Our current NDK setup only gets us half-way there to a way to run Yoga
// locally for unit tests. We're reusing the buck builds for now and hopefully
// someone (maybe you!) will fix this and get CMake to help us out.
task buckBuild(type: Exec) {
    workingDir rootDir
    environment BUCKVERSION: System.getenv('BUCKVERSION') ?: 'last'
    def buckPath = System.getenv('BUCK_PATH') ?: 'buck'
    commandLine buckPath, 'build', '//lib/yogajni:jni#default,shared'
    doLast {
        System.out.println("Exit value: ${executionResult.get().exitValue}")
        def pwd = 'pwd'.execute().text.trim()
        System.out.println("pwd: ${pwd}")

        def all_contents = 'ls'.execute().text.trim()
        System.out.println("all:\n ${all_contents}")

        def from_contents = 'find buck-out/gen/lib/yogajni/jni#default,shared/'.execute().text.trim()
        System.out.println("source:\n ${from_contents}")


    }
}
